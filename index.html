<!doctype html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>JavaScript MIDI player</title>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
        <script type="text/javascript" src="wildwebmidi.js"></script>
        <script type="text/javascript" src="midiplayer.js"></script>
        <script type="text/javascript" src="example-song.js"></script>
        <link rel="stylesheet" href="midiplayer.css">
    </head>
    <body>
        <div style="position: fixed; top: 50%; left: 50%; margin-top: -50px; margin-left: -225px;"> 
            <a href="javascript:startPlaying();">Play</a>
            <div id="player"></div>
        </div>
        <script type="text/javascript">
            const params = new URLSearchParams(window.location.search);
            const query = params.get('mid');
            var midiUpdate = function(time) {
                console.log(time);
            }
            var midiStop = function() {
                console.log("Stop");
            }
            
            function startPlaying() {
                var song = `data:audio/midi;base64,${query}`;
                $("#player").midiPlayer.play(song);
            }

            $( document ).ready(function() {
                $("#player").midiPlayer({
                    color: "red",
                    onUpdate: midiUpdate,
                    onStop: midiStop,
                    width: 250
                });
          });
        </script>
  </body>
</html>
